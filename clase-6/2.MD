## FUNCION

```SQL
CREATE FUNCTION fn_ObtenerConteoLikes
(
    @PublicacionID INT
)
RETURNS INT
AS
BEGIN
    DECLARE @Conteo INT;
    SELECT @Conteo = COUNT(*)
    FROM Likes
    WHERE PublicacionID = @PublicacionID;
    RETURN @Conteo;
END;
```

## TRIGGER 

```sql
-- TRIGGER
CREATE TRIGGER tr_AuditarCambiosUsuario
ON Usuarios
AFTER UPDATE
AS
BEGIN
    SET NOCOUNT ON;
    IF UPDATE(Email)
    BEGIN
        INSERT INTO AuditoriaUsuarios (UsuarioID, CampoModificado, ValorAntiguo, ValorNuevo, FechaModificacion)
        SELECT i.UsuarioID, 'Email', d.Email, i.Email, GETDATE()
        FROM inserted i
        INNER JOIN deleted d ON i.UsuarioID = d.UsuarioID
        WHERE i.Email <> d.Email;
    END;
    IF UPDATE(NombreUsuario)
    BEGIN
        INSERT INTO AuditoriaUsuarios (UsuarioID, CampoModificado, ValorAntiguo, ValorNuevo, FechaModificacion)
        SELECT i.UsuarioID, 'NombreUsuario', d.NombreUsuario, i.NombreUsuario, GETDATE()
        FROM inserted i
        INNER JOIN deleted d ON i.UsuarioID = d.UsuarioID
        WHERE i.NombreUsuario <> d.NombreUsuario;
    END;
END;

```